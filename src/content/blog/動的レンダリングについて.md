---
title: "動的レンダリングについて"
id: rjvb8h6
public: false
publishedAt: 2023-06-11
editedAt: null
description: "ブログをNext.jsで作成していた際の問題 Next.js 13でapp directoryを用いてブログを作成している際、head内に指定しているogpがTwitter等で反映されない問題にぶつか"
tags:

---


## ブログをNext.jsで作成していた際の問題

Next.js 13でapp directoryを用いてブログを作成している際、head内に指定しているogpがTwitter等で反映されない問題にぶつかった。

参照（自分のスクラップ）

[https://zenn.dev/uenishi_com/scraps/91bb81aa5ea5d5](https://zenn.dev/uenishi_com/scraps/91bb81aa5ea5d5)

![](https://twitter.com/otoyo0122/status/1606545045376860166?s=20)

結果的に、上記のツイートより、

```javascript
export const dynamic = 'force-dynamic'
```

を追加することで問題は解決しました。が、ページの表示速度が劇的に遅くなってしまった……。

こちら劇的に遅くなった旧ブログ 

[https://my-notion-blog-nmdk2ow4m-keitauenishi.vercel.app/posts](https://my-notion-blog-nmdk2ow4m-keitauenishi.vercel.app/posts)


そもそもの話、わかっていないこととして

- Next.jsのapp directoryの仕組み（レンダリングのプロセスなど）
- RSC（React Server Component）がなんぞや
- Dinamic Renderingとは何か

など、諸々あるのですが…

今回は「Dinamic Renderingとは何か」をまず調べつつ、なぜNext13のapp directoryでは現状Dinamic RenderingをしなければTwitter等でogpが反映されなかったのか。

という部分を深掘りして、知識を深めていこうと思います！

## Dinamic Renderingとは？

[https://developers.google.com/search/docs/crawling-indexing/javascript/dynamic-rendering?hl=ja](https://developers.google.com/search/docs/crawling-indexing/javascript/dynamic-rendering?hl=ja)

> ダイナミック レンダリングは回避策であり、JavaScript 生成コンテンツに関して検索エンジンで生じる問題の根本的な解決策ではありません。代わりに、[サーバーサイドのレンダリング](https://web.dev/rendering-on-the-web/?hl=ja#server-rendering)、[静的なレンダリング](https://web.dev/rendering-on-the-web/?hl=ja#static-rendering)、[ハイドレーション](https://web.dev/rendering-on-the-web/?hl=ja#combining-server-rendering-and-csr-via-rehydration)のいずれかで解決することをおすすめします。

Googleさんのページを見にいくと、早速「回避策としてのダイナミックレンダリング」とはっきり書かれており、非推奨なレンダリング方法とのことでした。

ここからは引用しつつ、解釈を記載していきます。

> ダイナミック レンダリングは、検索エンジンが JavaScript 生成コンテンツに対応していない場合のウェブサイトでの回避策です。ダイナミック レンダリング サーバーは、JavaScript 生成コンテンツに関して問題がある可能性のある bot を検知し、検知した bot にはサーバーでレンダリングした JavaScript なしのバージョンのコンテンツを提供する一方で、ユーザーに対してはクライアントサイドでレンダリングされたバージョンのコンテンツを表示します。

つまり、ダイナミックレンダリングとは何をするのかというと、

- 実際にWebサイトに訪れたユーザー
→ クライアントサイドレンダリングされたコンテンツを送る
- 検索エンジン（クローラー）
→ サーバーサイドで完全にレンダリングされたコンテンツを送る


というように、リクエストを行った対象がユーザーかクローラーによって、コンテンツの返却方法を変える（より最適な方法で返却するようにする）仕組みということのようです。

ただ、この方法は「回避策」であり、そもそもSSR(Server Side Rendering)などで静的なコンテンツを返却する等の方法が公式でも推奨されています。

前述のTwitterでの回答も、「応急処置として」と記載されていたように、現代においてはあまりいい方法ではないという認識がスタンダードなようです。

### なぜそんなことをするのか？

GoogleのクローラーはJavaScriptを解釈することはできるが、処理に時間がかかる可能性があり、また常に完全に解釈できないこともある。そのため、SEOに悪影響を及ぼす恐れがある。

最も確実なのは、サーバーサイドで静的なHTMLを返して、それをクローラーに認識してもらうこと。

そのため、解決策としてSSRやSSGなどといった手法で事前にコンテンツを生成するのがSEO向上には吉。

ここまで調べて、書いていて思ったのは、Next13でのapp directory下のコンポーネントはデフォルトでSSRされるのでは？ ということ。

つまり、SSRされている、という前提であれば、ダイナミックレンダリングをする必要はそもそも感じない（サーバーサイドにリクエストを送信した段階でコンテンツを生成しているため、返却されているのはJavaScriptではなく静的なHTMLコンテンツのはず）。

ここでapp directoryのレンダリングの仕組みを合わせて見ていくことで、どういった現象が発生していたのかを深掘りしていきたい。

## app directoryのレンダリングの仕組み



## 参考

[https://www.seojapan.com/blog/dynamic-rendering-seo](https://www.seojapan.com/blog/dynamic-rendering-seo)

[https://zenn.dev/kiyoshiro9446/scraps/06f5db30f68a31](https://zenn.dev/kiyoshiro9446/scraps/06f5db30f68a31)